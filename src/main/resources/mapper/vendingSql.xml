<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.lotte.vending.VendingDao">

	<select id="allVendingCount" resultType="Integer">
		select count(*)
		from vending
	</select>
	
	<select id="errVendingCount" resultType="Integer">
		select count(*)
		from errorInfo
	</select>
	
	
	<select id="problemVending" resultType="HashMap">
	
	<![CDATA[
		SELECT 		errorinfo.vending_id, asinfo.as_name,asinfo.as_id, asinfo.as_phone,'고장' as 'state'
		FROM 		asinfo,errorinfo
		WHERE 		(errorinfo.vending_id=errorinfo.vending_id and
					 asinfo.as_id=errorinfo.as_id)
		union
		
		SELECT 		stocks.vending_id, asinfo.as_name,asinfo.as_id, asinfo.as_phone, '재고 부족	' as 'state'
		FROM 		ojt.stocks, asinfo
		WHERE 		stocks.stock_quantity<6
		GROUP BY 	stocks.vending_id;
		
	]]>
	</select>
	

</mapper>


        
   